<!-- Describe task in general -->
<style>
	img.tile {
		border: 1px solid #294270;
		position: relative;
		top: 10px;
	}
</style>
<p> <!-- Introduction -->
	Эта миссия является адаптацией игры "Сеть" (из
	<a href="https://www.chiark.greenend.org.uk/~sgtatham/puzzles/">
	коллекции головоломок Саймона Тэтхема</a>).
	Если вы не знакомы с этой игрой, или просто хотите поиграть, то вам
	<a href="https://www.chiark.greenend.org.uk/~sgtatham/puzzles/js/net.html">сюда</a>.
</p>

<p> <!-- Description -->
	У вас есть прямоугольная сетка с плитками. Изначально плитки не связаны между собой, как они должны быть.
	Вам предстоит <strong>собрать сеть, вращая каждую плитку</strong>.
</p>

<p style="text-align: center">
	<strong>Удачным решением будет полностью подключенная сеть без замкнутых петель.</strong>
</p>

<p> <!-- Tiles -->
	Есть четыре типа плиток:
	<ul>
		<li>Тупик                  <img class="tile for_info_only" src="{{MEDIA}}W.png"   alt="W"   title="W tile"/></li>
		<li>Прямая дорога          <img class="tile for_info_only" src="{{MEDIA}}NS.png"  alt="NS"  title="NS tile"/></li>
		<li>Поворот на 90&deg;     <img class="tile for_info_only" src="{{MEDIA}}NE.png"  alt="NE"  title="NE tile"/></li>
		<li>Т-образный перекрёсток <img class="tile for_info_only" src="{{MEDIA}}WSE.png" alt="WSE" title="WSE tile"/></li>
	</ul>
</p>

<p> <!-- Schematized by -->
	Плитка обозначается направлениями, на которые она указывает (<strong>N</strong>orth (север), 
	<strong>S</strong>outh (юг), <strong>W</strong>est (запад), <strong>E</strong>ast (восток)).
	Например «NE», если плитка указывает на север и восток, тогда это поворот на 90&deg;.
</p>

<p>
	Обратите внимание, что порядок букв в строке (например: «NSE» и «ENS») не имеет значения.
	Это справедливо для входных и выходных данных.
</p>

<!-- Example with an image. -->
<pre class="for_info_only" style="text-align: center">
<img src="{{MEDIA}}5x5-example.png" alt="5x5 example: input and output images."/>

[['NW' , 'S'  , 'N'  , 'E'  , 'SE'],       [['SE' , 'W'  , 'S'  , 'E'  , 'SW'],
 ['NS' , 'W'  , 'NWE', 'NWE', 'SE'],        ['NS' , 'S'  , 'NSE', 'WSE', 'NW'],
 ['WSE', 'NSE', 'NWE', 'W'  , 'E' ],  ===\  ['NSE', 'NWE', 'NWS', 'N'  , 'S' ],
 ['WE' , 'WS' , 'WSE', 'SE' , 'WE'],  ===/  ['NS' , 'SE' , 'NWE', 'SW' , 'NS'],
 ['W'  , 'NE' , 'N'  , 'NW' , 'WS']]        ['N'  , 'NE' , 'W'  , 'NE' , 'NW']]
</pre>


<!-- Explain input and output values -->
<p>
	<strong>Входные данные:</strong>
	Список, содержащий списки целых чисел.
</p>

<p>
	<strong>Выходные данные:</strong>
	Список/кортеж, содержащий списки/кортежи целых чисел.
</p>


<!-- Put some usage examples -->
<div class="for_info_only">
<p>
	<strong>Пример:</strong>
</p>

<pre class="brush: python">
checkio([['NW' , 'S'  , 'N'  , 'E'  , 'SE'],
         ['NS' , 'W'  , 'NWE', 'NWE', 'SE'],
         ['WSE', 'NSE', 'NWE', 'W'  , 'E' ],
         ['WE' , 'WS' , 'WSE', 'SE' , 'WE'],
         ['W'  , 'NE' , 'N'  , 'NW' , 'WS']]) == [['SE' , 'W'  , 'S'  , 'E'  , 'SW'],
                                                  ['NS' , 'S'  , 'NSE', 'WSE', 'NW'],
                                                  ['NSE', 'NWE', 'NWS', 'N'  , 'S' ],
                                                  ['NS' , 'SE' , 'NWE', 'SW' , 'NS'],
                                                  ['N'  , 'NE' , 'W'  , 'NE' , 'NW']]
</pre>

<p>
	Сыграть в головоломку / проверить себя:
	<a href="https://www.chiark.greenend.org.uk/~sgtatham/puzzles/js/net.html#3x3:684d79261" title="3 строки, 3 колонки: сетка=[['NW', 'S', 'W'], ['WSE', 'NWE', 'SE'], ['N', 'NW', 'E']]">1</a>
	<a href="https://www.chiark.greenend.org.uk/~sgtatham/puzzles/js/net.html#3x6:461a585973b9cbc941" title="6 строки, 3 колонки: сетка=[['W', 'NW', 'E'], ['NS', 'WE', 'S'], ['WE', 'SE', 'NWE'], ['NE', 'NSE', 'SE'], ['WS', 'NSE...">2</a>
	<a href="https://www.chiark.greenend.org.uk/~sgtatham/puzzles/js/net.html#5x5:68219a4779db7415cd954326c" title="5 строки, 5 колонки: сетка=[['NW', 'S', 'N', 'E', 'SE'], ['NS', 'W', 'NWE', 'NWE', 'SE'], ['WSE', 'NSE', 'NWE', 'W', '...">3</a>
	<a href="https://www.chiark.greenend.org.uk/~sgtatham/puzzles/js/net.html#8x4:9946d2248bb2dbe52cdd3a9c2a324ea8" title="4 строки, 8 колонки: сетка=[['SE', 'SE', 'W', 'NW', 'WSE', 'N', 'N', 'W'], ['S', 'NSE', 'NSE', 'N', 'WSE', 'NSE', 'NWS...">4</a>
	<a href="https://www.chiark.greenend.org.uk/~sgtatham/puzzles/js/net.html#6x6:1ae8c825bed8ce978252adad226b184b5bb2" title="6 строки, 6 колонки: сетка=[['E', 'NS', 'NWS', 'S', 'WS', 'S'], ['N', 'WE', 'NSE', 'NWS', 'WSE', 'S'], ['WS', 'NWS', '...">5</a>
	<a href="https://www.chiark.greenend.org.uk/~sgtatham/puzzles/js/net.html#7x7:4184928aa53b853b787b91eb7756246e964a7c7ea4c3198c3" title="7 строки, 7 колонки: сетка=[['W', 'E', 'S', 'W', 'SE', 'N', 'S'], ['NS', 'NS', 'WE', 'NE', 'NSE', 'S', 'WE'], ['NE', '...">6</a>
	<a href="https://www.chiark.greenend.org.uk/~sgtatham/puzzles/js/net.html#9x6:14e11ea826bde2d7358129b68d7e152d81b554c6be21a37ab96d88" title="6 строки, 9 колонки: сетка=[['E', 'W', 'NWS', 'E', 'E', 'NWS', 'NS', 'S', 'N'], ['NW', 'NSE', 'WSE', 'NWS', 'N', 'WSE'...">7</a>
	<a href="https://www.chiark.greenend.org.uk/~sgtatham/puzzles/js/net.html#5x15:86189a5c2acddbc8bd648499a9d3a54d879137b86b762c7cd21bc3bcd44d1b31ecd2261c5a2" title="15 строки, 5 колонки: сетка=[['S', 'NW', 'E', 'S', 'SE'], ['NS', 'WE', 'WS', 'N', 'NS'], ['WS', 'WSE', 'WSE', 'NSE', 'W...">8</a>
	<a href="https://www.chiark.greenend.org.uk/~sgtatham/puzzles/js/net.html#11x11:184713984c2a51a1769ad67bdb3a17e92d14ddb96428d98987dbebb142b9d4db6a8337ad9818529c4eeb381e7bda7ac7785a458e523e2dc1941815b22" title="11 строки, 11 колонки: сетка=[['E', 'S', 'W', 'NWE', 'E', 'NE', 'SE', 'S', 'W', 'WS', 'N'], ['NS', 'WE', 'E', 'NS', 'E',...">9</a>
	<a href="https://www.chiark.greenend.org.uk/~sgtatham/puzzles/js/net.html#20x20:648db845aa98928b5232722852da5aeeebd99ed2b854589892ad19eaeca8d3597a92a23e4ac19b68a2cd22a6d517ed11448ab7a7c56abd87738abdb622657a828bbcb8a3d5c48463aa5a43d438cde463ee12bbdbca3eaa7d3a32bac2d819bebe88ed2961b1b9322dcc784ebcc53b4199e7ed99cdab3896266a77dd64995a1e5e55512cd4c8e5452ae7ca3a844d58d779ce8d9855b1372a193566a36a4d777ae4dd473a83ece58d2728e65348714aa8a64e939cbbe82d92eb985cece81a85c5181b39512838988724" title="20 строки, 20 колонки: сетка=[['NW', 'W', 'S', 'WSE', 'NSE', 'S', 'W', 'WE', 'NS', 'NS', 'SE', 'S', 'SE', 'N', 'S', 'NSE...">10</a>
	<a href="https://www.chiark.greenend.org.uk/~sgtatham/puzzles/js/net.html#25x25:1b499962a918382d286c5a57187458165a75a664781dd498222da9e48137e34ba335b117dd999e158c355498d65bb325a242a3c47d15cb1d57c577a36722ba6ad9ecd2714ada86548b9a9c51815d86935e455aeda45ced45ce6d7446a3525bca9a8bc7d258a49e93bd33d3e4e28254a1a55379265d148d8bb9877798993dd337c8745ae8584bd6a5a734ca2dab8e553d86b77b6da81a4bd129d9d7bd775ab13b7d7c23ca995662e32b7e4783dc17bcc683e985c655e8e8a2b4e485a89c425bb7bcbdea681da562589eebab75172d8bce83a5cee64a14e1e5729386729de97d86e849594d8dacd15aca952a3dc348d383c8dc2e445b5879b653a23e8eb2cedcec6d948d1a2d5ec258a956a8acda5177e8b14442e77a46bd61888a9e4cb76aba6a497c8e19b55481b214a75918215628714ba5225b215b723b2" title="25 строки, 25 колонки: сетка=[['E', 'NSE', 'W', 'SE', 'SE', 'SE', 'NW', 'N', 'NS', 'SE', 'E', 'S', 'NE', 'S', 'N', 'WSE'...">11</a>
	<a href="https://www.chiark.greenend.org.uk/~sgtatham/puzzles/js/net.html#40x25:3c42c9d521891a561c92682daa4849aaaa2944834a58e4991c65423dbd88d7b782bdebaaae5b437d4771b55ed3d6b2632a4ea5e228da54ca221439b854ce61617d24e5e29d579142b3d23ad575c45582a98c566bb24898dbb98967cec47d6c54c91aa71ab73b2c45eded72242d7b371533d5259ebceddea6217eddcecd44a5a22146e48ab57246e241e5183413a1585417215e77b6147d5e3498bc424de125d117b218baa12ecc9b35a4279599eab815eeaadde42753ddb55e5badd5bee9e9679971399dbda546524ad316b5a347ab5411eed47bae3aaead63a577d37ede2558d7a382819d97ccee92195634c5a2e214a3ee4a2185c1719abd83be86266bc672c5118318a5a6461ecaa8ba66a99abd5add969995ddcda3695a1775ebec67ad7d4bc85b11b3e4cdd31abdbde4a692114583ab3487818deb7628ee2346d8644194d8283db74e3dd736a3217a8b75c7be4153a42cb66558bead28442ce8ceb4818d72a1b436777a799a425d62244b645bb4b8a385ab784294d3c1c9d2a5a4936849a9d5ede1b52de7de37aeba6d41243a753651257c9ab2c1a2b6ad584e12c4b536957941b16ddbb766e25155d2751786a73664e1e9eeedb1c211a5d1d997d3a7d8581b9994777a83358849dde8486a38a23a151e34d987a1d7e2ba9e2ebdb311c39ec2ab985c492a68ac8388a3c921c928143caa44" title="25 строки, 40 колонки: сетка=[['NE', 'WS', 'W', 'N', 'WS', 'SE', 'WSE', 'WE', 'N', 'E', 'S', 'SE', 'E', 'NS', 'WE', 'NW'...">12</a>
</p>
</div>

<p>
	<strong>Предусловия:</strong>
	<ul>
		<li>Все предоставленные головоломки имеют решение.</li>
		<li>3 &le; len(grid) &le; 25,
		3 &le; len(grid[0]) &le; 40.</li>
		<li>all(len(row) == len(grid[0]) for row in grid).</li>
	</ul>
</p>
